<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>jQuery Heatmap</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<div id="heatmap"></div>
<div id="heatmap_2"></div>
<script src="../vendor/components/jquery/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<script src="../dist/jquery.heatmap.js"></script>
<script>
    (function ($) {
        function generateRandomDataForYear(year = 2025) {
            const data = [];
            const startDate = new Date(year+"-01-01");
            const endDate = new Date(year+"-12-31");

            let currentDate = startDate;

            while (currentDate <= endDate) {
                data.push({
                    date: currentDate.toISOString().split("T")[0], // Nur das Datum (YYYY-MM-DD)
                    count: Math.floor(Math.random() * 10) // Zufällige Zahl zwischen 0 und 100
                });

                // Einen Tag hinzufügen
                currentDate.setDate(currentDate.getDate() + 1);
            }

            return data;
        }

        function generateHeatmapDataForWord() {
            const data = [];
            const year = 2024;
            const lowValue = 0;   // Hintergrundwerte

            // Raster-Definition für das Wort "Heatmap" - Buchstaben im 7x52 Layout (Tage/Wochen)
            const heatmapWord = [
                "*  * **** ***                       ", // So
                "*  * *    *  * ***** M   M **** ****", // Mo
                "**** **** ****   *   MM MM *  * *  *", // Di
                "*  * *    *  *   *   M M M **** **** ", // Mi
                "*  * **** *  *   *   M   M *  * *    ", // Do
                "             *   *   M   M *  * *    ", // Fr
            ];

            // Startdatum setzen
            let currentDate = new Date(`${year}-01-01`);

            let week = 0; // Kalenderwoche
            while (week < heatmapWord[0].length && currentDate.getFullYear() === year) {
                for (let day = 0; day < 7 && currentDate.getFullYear() === year; day++) {
                    // Prüfen, ob an der aktuellen Position ein Buchstaben-Pixel ist
                    const char = heatmapWord[day]?.[week] || " ";
                    const count = char.trim() !== "" ? (Math.floor(Math.random() * 21) + 20) : lowValue; // Hoher Wert für Nicht-Leerzeichen

                    data.push({
                        date: currentDate.toISOString().split("T")[0],
                        count: count,
                    });

                    // Zum nächsten Tag weiterschalten
                    currentDate.setDate(currentDate.getDate() + 1);
                }
                week++;
            }

            return data;
        }

        $(document).ready(function () {
            $('#heatmap')
                .heatmap({
                    gutter: 2,
                    cellSize: 14,
                    locale: 'de',
                    startDate: '2024-01-01',
                    endDate: '2024-12-31',
                    data: generateHeatmapDataForWord()
                })


            $('#heatmap_2')
                .heatmap({
                    startDate: '2025-01-01',
                    endDate: '2025-12-31',
                    gutter: 2,
                    cellSize: 14,
                    locale: 'en',
                    debug:true,
                    data: generateRandomDataForYear(2025),
                    titleFormatter(locale, date, count) {
                        const dayFormatter = new Intl.DateTimeFormat(locale, {weekday: 'long'}).format(date);
                        return `${dayFormatter} ${date.toLocaleDateString()}<br>(${count} Entries)`;
                    }
                })
                .on('post.heatmap', function (e, el, data) {
                    el.find('[data-bs-toggle="tooltip"]').tooltip();
                })
        })

        let i = 0;
        // setInterval(() => {
        //     $('#heatmap').heatmap('updateOptions', {
        //         data: i%3 !== 0 ? generateRandomDataFor2024() : generateHeatmapDataForWord(),
        //     });
        //     i++;
        // }, 1000);
    }(jQuery))

</script>
</body>
</html>
